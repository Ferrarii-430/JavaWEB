//fuck   H    Test   %34%37%2E%31%30%36%2E%31%31%39%2E%32%34%31
var H="localhost:8080/";
var Test="www.phphwo.cn";
//htp   ssl
var ssl="http://";
var htp="https://";
var Testhtml="/HTML/Test.html";
var Loginhtml="/HTML/Login.html";
var patrn_name=/[`~!@#$%^&*()_+<>?:"{},.\/;'[\]]/im;
var symbol="\\";
let friend_headimg={};
const maxsize = 2 * 1024 * 1024;//2M
var fuck=(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(![]+[])[!+[]+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])(+!![]))[+[]]+([]+{})[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])(+!![]))[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![])([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])(+!![]))[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![])(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+[])+(+{}+[])[+!![]])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(+[]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(+[]+[])
var h5_primary_system="<h5 class=\"text-primary\">系统消息</h5>";
var h5_primary_friend="<h5 class=\"text-primary\">新的好友添加申请</h5>";
var h5_normal="<h5>系统消息</h5>";
var new_message="<div class=\"new-message-count\">1</div>";
var head_img_or_txt="<span class=\"avatar-title bg-success rounded-circle\">缘</span>";
var svg="<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-more-horizontal\"><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle><circle cx=\"5\" cy=\"12\" r=\"1\"></circle></svg>";
var toggle="<div class=\"action-toggle\">\n" +
    "                                        <div class=\"dropdown\">\n" +
    "                                            <a data-toggle=\"dropdown\" href=\"#\">\n" +
    "                                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-more-horizontal\"><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle><circle cx=\"5\" cy=\"12\" r=\"1\"></circle></svg>\n" +
    "                                            </a>\n" +
    "                                            <div class=\"dropdown-menu dropdown-menu-right\">\n" +
    "                                                <a href=\"#\" class=\"dropdown-item\">Open</a>\n" +
    "                                                <a href=\"#\" data-navigation-target=\"contact-information\" class=\"dropdown-item\">Profile</a>\n" +
    "                                                <a href=\"#\" class=\"dropdown-item\">Add to archive</a>\n" +
    "                                                <div class=\"dropdown-divider\"></div>\n" +
    "                                                <a href=\"#\" class=\"dropdown-item text-danger\">Delete</a>\n" +
    "                                            </div>\n" +
    "                                        </div>\n" +
    "                                    </div>";
/**
 *这一页的代码跟坨屎一样 冗余非常多 应该没人会来看这个东西吧
 */
function appendfriend(nickname,id,headimg,type) {
    var FriendText="聊天预览功能正在测试";
    var OnlineText="一个在线的用户";
    var name,text;
    name=nickname.trim();
    var fast=null;
    var headimg_data;
    if (type=="friend"){
        text=FriendText;
    }else {
        text=OnlineText;
    }
    if (headimg!="NoAvatar"){
        headimg_data="<img src=\" " + headimg + "  \" class=\"rounded-circle\" alt=\"image\">";
    }
    else {
        var index = escape(name).indexOf("%u");
        fast = name.substring(index, index+1);
        if (fast==""||fast==null){
            fast=name.substr(0,1);
        }
        headimg_data="<span class=\"avatar-title bg-secondary rounded-circle\">" + fast + "</span>";
    }
                                  //我在这里直接写个val就行 为什么还要写个隐藏span QaQ 我是nt
        const fried = "<li class=\"list-group-item\" value=\""+ id +"\">\n" +
            "                            <div>\n" +
            "                                <figure class=\"avatar\">\n" +
            "                                      " + headimg_data + "   \n" +
            "                                </figure>\n" +
            "                            </div>\n" +
            "                            <div class=\"users-list-body\">\n" +
            "                                <div>\n" +
            "                                    <h5>" + nickname + "</h5>\n" +
            "                                    <span class=\"realID\" style=\"display: none\">" + id + "</span>\n" +
            "                                    <p>" + text + "</p>\n" +
            "                                </div>\n" +
            "                                <div class=\"users-list-action\">\n" +
            "                                   <div></div>\n" +
            "                                    <small class=\"text-muted\">11:11 PM</small>\n" +
            "                                    <div class=\"action-toggle\">\n" +
            "                                        <div class=\"dropdown\">\n" +
            "                                            <a data-toggle=\"dropdown\" href=\"#\">\n" +
            "                                              " + svg + " \n" +
            "                                            </a>\n" +
            "                                            <div class=\"dropdown-menu dropdown-menu-right\">\n" +
            "                                                <a href=\"#\" class=\"dropdown-item\">添加好友</a>\n" +
            "                                                <div class=\"dropdown-divider\"></div>\n" +
            "                                                <a href=\"#\" class=\"dropdown-item text-danger\">删除</a>\n" +
            "                                            </div>\n" +
            "                                        </div>\n" +
            "                                    </div>\n" +
            "                                </div>\n" +
            "                            </div>\n" +
            "                        </li>";

    if (type=="friend") {
        friend_headimg[id] = headimg_data;
        $("#chats .sidebar-body ul").append(fried);
    }
    else if (type=="Online"){
        $("#chatroom .sidebar-body ul").append(fried);
    }
    else {
        console.log(type);
        console.log(id);
        console.log(nickname);
        console.log("加载用户列表未知错误")
    }
}




function getString_first(name){
    var fast;
    var index = escape(name).indexOf("%u");
    fast = name.substring(index, index+1);
    if (fast==""||fast==null){
        fast=name.substr(0,1);
    }
    return fast;
}


function appendfriend_apply(userid,text,time,state){
    var h5;
    var message="";
    if (state=="Unread"){
        h5=h5_primary_friend;
        message=new_message;
    }
    else {
        h5=h5_normal;
    }
    const system = "<li class=\"list-group-item Friend Notice\">\n" +
        "                            <figure class=\"avatar\">\n" +
        "                                <span class=\"avatar-title bg-facebook rounded-circle\">★</span>\n" +
        "                            </figure>\n" +
        "                            <div class=\"users-list-body\">\n" +
        "                                <div>\n" +
        "                                    "+h5+"          \n" +
        "                                    <p>新的好友添加申请</p>\n" +
        "                                    <span style='display: none' class='System-data'>friend|" + userid + "|" + text + "|"+ state + "|"+ time +"</span>\n" +
        "                                </div>\n" +
        "                                <div class=\"users-list-action\">\n" +
        "                                        "+message+"     \n" +
        "                                    <div class=\"action-toggle\">\n" +
        "                                        <div class=\"dropdown\">\n" +
        "                                            <a data-toggle=\"dropdown\" href=\"#\">\n" +
        "                                                   "+svg+" \n" +
        "                                            </a>\n" +
        "                                            <div class=\"dropdown-menu dropdown-menu-right\">\n" +
        "                                                <a href=\"#\" class=\"dropdown-item\">打开</a>\n" +
        "                                                <div class=\"dropdown-divider\"></div>\n" +
        "                                                <a href=\"javascript:get_click_number_more()\" class=\"dropdown-item text-danger\">删除</a>\n" +
        "                                            </div>\n" +
        "                                        </div>\n" +
        "                                    </div>\n" +
        "                                </div>\n" +
        "                            </div>\n" +
        "                        </li>";
    $("#archived .sidebar-body ul").append(system);
}


function appendsystem_notice(userid,text,time,state){
    var h5;
    var message="";
    if (state=="Unread"){
        h5=h5_primary_system;
        message=new_message;
    }
    else {
        h5=h5_normal;
    }
    const system = "<li class=\"list-group-item System Notice\">\n" +
        "                            <figure class=\"avatar\">\n" +
        "                                <span class=\"avatar-title bg-google rounded-circle\">★</span>\n" +
        "                            </figure>\n" +
        "                            <div class=\"users-list-body\">\n" +
        "                                <div>\n" +
        "                                       "+h5+"  \n" +
        "                                    <p>管理员发送来的通知</p>\n" +
        "                                    <span style='display: none' class='System-data'>system|" + userid + "|" + text + "|" + state + "|"+ time +"</span> \n" +
        "                                </div>\n" +
        "                                <div class=\"users-list-action\">\n" +
        "                                      "+message+"  \n" +
        "                                    <div class=\"action-toggle\">\n" +
        "                                        <div class=\"dropdown\">\n" +
        "                                            <a data-toggle=\"dropdown\" href=\"#\">\n" +
        "                                                 "+svg+"  \n" +
        "                                            </a>\n" +
        "                                            <div class=\"dropdown-menu dropdown-menu-right\">\n" +
        "                                                <a href=\"#\" class=\"dropdown-item\">打开</a>\n" +
        "                                                <div class=\"dropdown-divider\"></div>\n" +
        "                                                <a href=\"javascript:get_click_number_more()\" class=\"dropdown-item text-danger\">删除</a>\n" +
        "                                            </div>\n" +
        "                                        </div>\n" +
        "                                    </div>\n" +
        "                                </div>\n" +
        "                            </div>\n" +
        "                        </li>";

    $("#archived .sidebar-body ul").append(system);
}


function appendfriend_chatwindow(friend_id){
    var friend_window="<div class=\"messages\" id=\""+friend_id+"\"></div>";
    $(".layout .content .chat .chat-body").append(friend_window);
}


function append_chatdata(receiveID,userid,nick,text,type,time){
    if(type=="txt"){
        append_txt(receiveID,userid,nick,text,time);
    }
    else if (type=="img"){
        append_img(receiveID,userid,nick,text,time);
    }
    else if(type=="mp3"){
        append_mp3(receiveID,userid,nick,text,time);
    }
    else {
        console.log("添加聊天记录出错");
    }
}

function append_txt(receiveID,userid,nick,text,time){
    if (userid!=ID){
        var myself="<div class=\"message-item\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+friend_headimg[receiveID]+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nick+"</h5>\n" +
            "                                <div class=\"time\">"+time+"</div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <div class=\"message-content\">\n" +
            "                            "+text+" \n" +
            "                        </div>\n" +
            "                    </div>";
        $('.layout .content .chat .chat-body #'+receiveID+'').append(myself);
    }else {
        var outgoing="<div class=\"message-item outgoing-message\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+friend_headimg[userid]+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nick+"</h5>\n" +
            "                                <div class=\"time\">"+time+"<i class=\"ti-double-check text-info\"></i></div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <div class=\"message-content\">\n" +
            "                           "+text+" \n" +
            "                        </div>\n" +
            "                    </div>";
        $('.layout .content .chat .chat-body #'+receiveID+'').append(outgoing);
    }
}


function append_img(receiveID,userid,nick,text,time){
    if (userid!=ID){
        var myself="<div class=\"message-item\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+friend_headimg[receiveID]+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nick+"</h5>\n" +
            "                                <div class=\"time\">"+time+"</div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <figure>\n" +
            "                            <a href=''><img src=\""+text+"\" class=\"w-35 img-fluid rounded\" alt=\"image\"></a>    \n" +
            "                        </figure>\n" +
            "                    </div>";
        $('.layout .content .chat .chat-body #'+receiveID+'').append(myself);
    }else {
        var outgoing="<div class=\"message-item outgoing-message\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+friend_headimg[userid]+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nick+"</h5>\n" +
            "                                <div class=\"time\">"+time+"<i class=\"ti-double-check text-info\"></i></div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <figure>\n" +
            "                            <a href=''><img src=\""+text+"\" class=\"w-35 img-fluid rounded\" alt=\"image\" style='float: right'></a>\n" +
            "                        </figure>\n" +
            "                    </div>";
        $('.layout .content .chat .chat-body #'+receiveID+'').append(outgoing);
    }
}

function append_mp3(receiveID,userid,nick,text,time){
    if (userid!=ID){
        var myself=" <div class=\"message-item\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+friend_headimg[receiveID]+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nick+"</h5>\n" +
            "                                <div class=\"time\">"+time+"<i class=\"ti-double-check text-info\"></i></div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <div class=\"message-content\">\n" +
            "                        <audio controls>\n" +
            "                        <source src=\""+text+"\">\n" +
            "                        </audio>  \n" +
            "                        </div>\n" +
            "                    </div>";

        $('.layout .content .chat .chat-body #'+receiveID+'').append(myself);
    }else {
        var outgoing="<div class=\"message-item outgoing-message\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+friend_headimg[userid]+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nick+"</h5>\n" +
            "                                <div class=\"time\">"+time+"<i class=\"ti-double-check text-info\"></i></div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <div class=\"message-content\">\n" +
            "                        <audio controls>\n" +
            "                        <source src=\""+text+"\">\n" +
            "                        </audio>  \n" +
            "                        </div>\n" +
            "                    </div>";

        $('.layout .content .chat .chat-body #'+receiveID+'').append(outgoing);
    }
}


//ajax 判断头像是否存在
function isExistFile(filepath, filename){
    if(filepath ==null ||filename ==null ||filepath ==undefined ||filename ==undefined || filepath =="" || filename ==""){
        return false
    }
    var xmlhttp;
    if (window.XMLHttpRequest){
        xmlhttp=new XMLHttpRequest();
    }else{
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.open("GET",filepath + filename,false);
    xmlhttp.send();
    if(xmlhttp.readyState==4){
        if(xmlhttp.status==200) return true; //url存在
        else if(xmlhttp.status==404) return false; //url不存在
        else return false;//其他状态
    }
}


/**
 * 添加聊天室数据主要函数 内容极其冗余 后期记得优化
 */
function append_room_chatdata(userid,nickname,chat,type,headimg,date){
    switch (type){
        case "txt": append_room_txt(userid,nickname,chat,headimg,date);break;
        case "img":append_room_img(userid,nickname,chat,headimg,date);break;
        case "mp3":append_room_mp3(userid,nickname,chat,headimg,date);break;
        case "imgAll":append_room_img(userid,nickname,chat,headimg,date);break;
        case "mp3All":append_room_mp3(userid,nickname,chat,headimg,date);break;
        default:console.log("userid:"+userid);
            console.log("nickname:"+nickname);
            console.log("chat:"+chat);
            console.log("type:"+type);
            console.log("headimg:"+headimg);
            console.log("date:"+date);
            console.log("添加聊天记录出错");
            break;
    }
}


function get_headIMGdata(headimg,userid,nickname){
    var name_data;
    var headimg_data;
    if (headimg=="yes"){
        name_data=htp+Test+"/headimg"+"/"+userid+".jpg";
        headimg_data="<img src=\" " + name_data + "  \" class=\"rounded-circle\" alt=\"image\">";
    }else {
        name_data=getString_first(nickname);
        headimg_data="<span class=\"avatar-title bg-secondary rounded-circle\">" + name_data + "</span>";
    }
    return headimg_data;
}



function append_room_txt(userid,nickname,chat,headimg,date){
    var IMG_data=get_headIMGdata(headimg,userid,nickname);
    if (userid!=ID){
        var myself="<div class=\"message-item\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+IMG_data+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nickname+"</h5>\n" +
            "                                <div class=\"time\">"+date+"</div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <div class=\"message-content\">\n" +
            "                            "+chat+" \n" +
            "                        </div>\n" +
            "                    </div>";
        $('.layout .content .chat .chat-body #chatroom-messages').append(myself);
    }else {
        var outgoing="<div class=\"message-item outgoing-message\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+IMG_data+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nickname+"</h5>\n" +
            "                                <div class=\"time\">"+date+"<i class=\"ti-double-check text-info\"></i></div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <div class=\"message-content\">\n" +
            "                           "+chat+" \n" +
            "                        </div>\n" +
            "                    </div>";
        $('.layout .content .chat .chat-body #chatroom-messages').append(outgoing);
    }
}


function append_room_img(userid,nickname,chat,headimg,date){
    var IMG_data=get_headIMGdata(headimg,userid,nickname);
    if (userid!=ID){
        var myself="<div class=\"message-item\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+IMG_data+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nickname+"</h5>\n" +
            "                                <div class=\"time\">"+date+"</div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <figure>\n" +
            "                            <a href=''><img src=\""+chat+"\" class=\"w-35 img-fluid rounded\" alt=\"image\"></a>\n" +
            "                        </figure>\n" +
            "                    </div>";
        $('.layout .content .chat .chat-body #chatroom-messages').append(myself);
    }else {
        var outgoing="<div class=\"message-item outgoing-message\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+IMG_data+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nickname+"</h5>\n" +
            "                                <div class=\"time\">"+date+"<i class=\"ti-double-check text-info\"></i></div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <figure>\n" +
            "                            <a href=''><img src=\""+chat+"\" class=\"w-35 img-fluid rounded\" alt=\"image\" style='float: right'></a>      \n" +
            "                        </figure>\n" +
            "                    </div>";
        $('.layout .content .chat .chat-body #chatroom-messages').append(outgoing);
    }
}

function append_room_mp3(userid,nickname,chat,headimg,date){
    var IMG_data=get_headIMGdata(headimg,userid,nickname);
    if (userid!=ID){
        var myself=" <div class=\"message-item\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+IMG_data+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nickname+"</h5>\n" +
            "                                <div class=\"time\">"+date+"<i class=\"ti-double-check text-info\"></i></div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <div class=\"message-content\">\n" +
            "                        <audio controls>\n" +
            "                        <source src=\""+chat+"\">\n" +
            "                        </audio>  \n" +
            "                        </div>\n" +
            "                    </div>";

        $('.layout .content .chat .chat-body #chatroom-messages').append(myself);
    }else {
        var outgoing="<div class=\"message-item outgoing-message\">\n" +
            "                        <div class=\"message-avatar\">\n" +
            "                            <figure class=\"avatar\">"+IMG_data+"</figure>\n" +
            "                            <div>\n" +
            "                                <h5>"+nickname+"</h5>\n" +
            "                                <div class=\"time\">"+date+"<i class=\"ti-double-check text-info\"></i></div>\n" +
            "                            </div>\n" +
            "                        </div>\n" +
            "                        <div class=\"message-content\">\n" +
            "                        <audio controls>\n" +
            "                        <source src=\""+chat+"\">\n" +
            "                        </audio>  \n" +
            "                        </div>\n" +
            "                    </div>";

        $('.layout .content .chat .chat-body #chatroom-messages').append(outgoing);
    }
}

function swal_currency(title,text,icon){
    Swal.fire(title,text,icon);
}